{% extends "base.html" %}

{% block title %}Content Management Hub - Organize Conversations{% endblock %}

{% block content %}
<!-- Main Application -->
<div x-data="conversationBrowser()">
    <!-- Header -->
    {% set page_title="Organize Conversations" %}
    {% set show_new_client_button=True %}
    {% set show_new_project_button=True %}
    {% set show_new_folder_button=True %}
    {% include "components/header.html" %}

    <!-- Learning Goals Banner -->
    {% include "components/conversation_browser/learning_goals_banner.html" %}

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <!-- Loading State -->
        <div x-show="loading" class="flex items-center justify-center py-12">
            <div class="loading loading-spinner loading-lg"></div>
            <span class="ml-4 text-gray-600">Loading conversations...</span>
        </div>

        <!-- Error State -->
        <div x-show="error" class="bg-red-50 border border-red-200 rounded-md p-4 flex items-center">
            <svg class="h-5 w-5 text-red-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
            </svg>
            <span x-text="error"></span>
        </div>

        <!-- Content -->
        <div x-show="!loading && !error">
            <!-- Advanced Search Interface -->
            {% include "components/conversation_browser/search_filters.html" %}
            
            <!-- Status Overview Cards -->
            {% include "components/conversation_browser/status_overview.html" %}

            <!-- Root Level Conversations -->
            {% include "components/conversation_browser/root_conversations.html" %}

            <!-- Filtered Results Message -->
            {% include "components/conversation_browser/filtered_results_message.html" %}

            <!-- Project-Based Folders (hidden when filters are active) -->
            <div x-show="!hasActiveFilters()">
                {% include "components/conversation_browser/project_folders.html" %}
            </div>

            <!-- General Folders (hidden when filters are active) -->
            <div x-show="!hasActiveFilters()">
                {% include "components/conversation_browser/general_folders.html" %}
            </div>
        </div>
    </main>

    <!-- Include Modals -->
    {% include 'components/modals/client_modal.html' %}
    {% include 'components/modals/project_modal.html' %}
    {% include 'components/modals/folder_modal.html' %}
    {% include 'components/modals/content_status_modal.html' %}
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/conversation-browser.js"></script>
{% endblock %}
